<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Order Bill</title>
  <!-- Bootstrap CSS CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
    <div class="container">
      <a class="navbar-brand" href="index.html">Perfume Shop</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="#">About Us</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Contact</a></li>
        </ul>
        <div class="d-flex align-items-center">
          <span class="me-3" id="welcome-user"></span>
          <button id="logout-btn" class="btn btn-outline-danger btn-sm">Logout</button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Bill Container -->
  <div class="container my-5">
    <h2>Your Order Summary</h2>
    <div id="bill-container" class="mt-4">
      <table class="table table-bordered">
        <thead class="table-light">
          <tr>
            <th>Perfume</th>
            <th>Price (₹)</th>
            <th>Quantity</th>
            <th>Total (₹)</th>
          </tr>
        </thead>
        <tbody id="bill-items">
          <!-- Filled by JS -->
        </tbody>
        <tfoot>
          <tr>
            <th colspan="3" class="text-end">Grand Total</th>
            <th id="grand-total">₹0</th>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>

  <!-- Bootstrap Bundle JS (includes Popper) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- <script>
    // LOGOUT BUTTON
    document.getElementById('logout-btn').addEventListener('click', () => {
      localStorage.removeItem('loggedInUser');
      window.location.href = 'index.html';
    });

    // Show welcome user
    document.addEventListener('DOMContentLoaded', () => {
      const user = JSON.parse(localStorage.getItem('loggedInUser'));
      if (user && user.name) {
        document.getElementById('welcome-user').textContent = `Welcome, ${user.name}`;
      } else {
        // If no user logged in, redirect to login or index
        window.location.href = 'login.html';
      }
      loadBill();
    });

    // Load Bill from API
    function loadBill() {
      const user = JSON.parse(localStorage.getItem('loggedInUser'));
      if (!user) return;

      const userId = user.UserID;
      const apiUrl = `http://localhost:60565/api/cart/user/${userId}`;

      fetch(apiUrl)
        .then(res => {
          if (!res.ok) throw new Error('Failed to fetch cart items');
          return res.json();
        })
        .then(cartItems => {
          const tbody = document.getElementById('bill-items');
          tbody.innerHTML = '';

          if (!cartItems.length) {
            tbody.innerHTML = `<tr><td colspan="4" class="text-center">Your cart is empty.</td></tr>`;
            document.getElementById('grand-total').textContent = '₹0';
            return;
          }

          let grandTotal = 0;
          cartItems.forEach(item => {
            grandTotal += item.TotalPrice;
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>
                <img src="/images/${item.PerfumeImg}" alt="${item.PerfumeName}" style="width:50px; height:auto; margin-right:10px;">
                ${item.PerfumeName}
              </td>
              <td>₹${item.PerfumePrice}</td>
              <td>${item.CartQty}</td>
              <td>₹${item.TotalPrice}</td>
            `;
            tbody.appendChild(row);
          });
          document.getElementById('grand-total').textContent = `₹${grandTotal}`;
        })
        .catch(err => {
          console.error(err);
          const tbody = document.getElementById('bill-items');
          tbody.innerHTML = `<tr><td colspan="4" class="text-center text-danger">Failed to load bill data.</td></tr>`;
          document.getElementById('grand-total').textContent = '₹0';
        });
    }
  </script> -->
</body>
</html>
